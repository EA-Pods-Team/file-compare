<html>
    <head>
        <script src="./md5.js" type="text/javascript"></script>
<script src="./compromise.min.js"></script> 
<script type="text/javascript">

function read(){
    var fileSel = document.querySelector('#fileSel');
    fileData = [];
    for (var i = 0; i < fileSel.files.length; i++){
        


        readFileAt(fileSel,i).then(function(dict){
            
            fileData.push({
                "file": dict.file,
                hash: md5(dict.data)
            });
        });
    }
    
}

function readFileAt(fileSel, ind){
    return new Promise(function(resolve,reject){
        var reader = new FileReader();
        reader.onload = function(e){
            resolve({
                'data':e.target.result, 
                'file': fileSel.files[ind]});
        }
        reader.readAsBinaryString(fileSel.files[ind])
    });
}

getWords = function(words, speech){
    return Object.keys(words).filter(function(k){
        var val = words[k];
        if(Array.isArray(val)){
            for (var type of val){
                if(type == speech){
                    return true;
                }
            } return false;
        }else{
            return words[k]==speech;
        }
    });
}
Array.prototype.getRand = function(md5seed){
    return this[parseInt(md5seed,16) % this.length];
}


function makeSentence(seed){
    return [names, verbs, numbers, adjs, adjs, nouns].map(function (arr){
            return arr.getRand(seed += '1')
        }).join(' ');
}

window.onload = function(){
    allwords = nlp().world.words;
    nouns = getWords(allwords, 'Plural')
    numbers= getWords(allwords, 'Cardinal')
    adjs = getWords(allwords, 'Adjective')
    names = getWords(allwords,'FirstName')
    verbs = getWords(allwords, 'PastTense')
    adverbs = getWords(allwords, 'Adverb')
    preps = getWords(allwords, "Preposition")
}

</script>
    </head>
    <body>
        <div>
            <input id='fileSel' type="file" multiple>
            <button id='diffBtn' onclick='read()'>compare</button>
        </div>
    </body>
</html>